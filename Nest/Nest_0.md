# NestJS 시작 전에...

## 1. NestJS 란

NestJS 란 Node.js에 기반을 둔 웹 API 프레임워크이다. 

Express 또는 Fastify 프레임워크를 래핑하여 동작한다. 

> 래핑이란? 
**기존의 기능(예: Express)을 내부에서 사용하되, 바깥에서는 다른 방식으로 보이도록 감싸는 것**
> 

Node.js는 손쉽게 사용할 수 있고 뛰어난 확장성을 가지고 있지만, 과도한 유연함으로 인해 SW 품질이 오히려 떨어지는 단점이 있다. 

→ 때문에 NestJS 와 같은 프레임워크를 가지고 SW 의 품질을 높이며 Node.js 의 유연함은 그대로 살려준다. 

스프링처럼 구조화된 개발 방식을 적용해, 복잡한 서비스도 일관성 있게 관리할 수 있다.

또한 프로그래밍 언어는 TypeScript를 기본으로 채택하고 있기 떄문에 타입시스템의 장점을 누릴 수 있다.

## 2. **Express? NestJS?**

Express와 NestJS는 Node.js 기반 웹 서버를 만들기 위한 도구지만, 역할과 구조는 완전히 다르다. 

### **Express 란?**

- Node.js 위에서 만든 가장 널리 쓰이는 경량 웹 프레임워크
- 라우팅, 요청/응답 처리, 미들웨어 정도만 제공
- 아무 구조 없이 빠르게 서버를 만들 수 있음.
- 하지만 유지보수가 어려움

### **NestJS 란?**

- 내부적으로 Express 를 감싸고 사용하는 상위 프레임워크
    - Express 기반 구조를 구조화 해서 사용하게 만든 것
- 모듈화 / DI / 데코레이터 기반 아키텍처 제공
- Angular나 Spring과 매우 유사한 구조

### 정리하면

- Express는 Nest의 기초 엔진이고, Nest는 Express 를 “프레임워크답게 만들어주는 껍데기 + 설계도” 이다

## 3. Node.js 란 무엇일까?

- Node.js 한 줄 설명:
    - Node.js는 자바스크립트를 서버에서도 쓸 수 있게 만든 실행 환경이자, 웹 서버도 직접 만들 수 있는 런타임이다.
- Nest는 Node.js를 기반으로 동작한다.
    - 정확히는 Nest로 작성한 코드를 Node.js 기반 프레임워크인 Express나 Fastify에서 실행 가능한 자바스크립트 소스 코드로 컴파일 해주는 역할을 한다.
- 자바스크립트는 프론트엔드 언어??
    - 원래 자바스크립트는 프론트엔드에서 사용하는 언어라는 인식이 강했다.
    - 실제로 HTML 내에 <script> 로 삽입하여 많이 사용했다.
    - 브라우저를 열어봐도 HTML 파일과 script 의 내용이 노출되어 있어서 보안에 취약하다는 인식이 강했고, “그냥 스크립트 언어” 라는 무시를 받았다.
- 이후 Node.js 의 등장
    - 자바스크립트를 사용하여 서버를 구동할 수 있게 되었다.
    - 프론트엔드와 백엔드의 언어를 통일시켜 커뮤니케이션 비용을 줄이고 같은 개발자가 풀스택으로 개발하면서 생산성을 향상 시켰다.
    - 또한 2008년 구글은 크롬 브라우저를 출시하면서 자체 개발한 자바스크립트 엔진인 V8을 크롬에 내장하면서, 높은 성능으로 자바스크립트는 느리다는 인식을 바꾸어 주었다.

## 4. NPM(Node Package Manager)

- 패키지(또는 라이브러리) 관리 시스템이다.
- 누구나 자신이 만든 Node.js 기반 라이브러리를 등록하여 공개 할 수 있다.
- 설치한 패키지 정보는 package.json 파일에 기록돼서, 팀원 간 공유나 배포도 쉬워진다.

## 5. Node.js 의 특징

`단일 쓰레드에서 구동되는 non-blocking I/O 이벤트 기반 비동기 방식`

- 멀티 쓰레드 방식
    - 작업 요청이 한꺼번에 들어올 때 각 작업을 처리하기 위한 쓰레드를 만들고 할당하는 방식을 멀티 쓰레드 방식이라고 한다.
    - 여러 작업을 동시에 처리하기 때문에 빠르다!
    - 공유 자원을 관리하는 노력이 많이든다.
    - 쓰레드의 관리가 중요하다. (메모리 관점)
- 단일 쓰레드
    - 하나의 스레드로 모든 요청을 순차적으로 처리한다.
    - 비동기 + 이벤트 루푸를 활용해 작업 완료 알림만 받아 처리한다.
    - 병렬 처리는 없지만, 논블로킹 처리 덕분에 많은 요청을 빠르게 처리할 수 있다.
    - 공유 자원 이슈가 거의 없고 안정적이고 유지보수성이 좋다.
    - 하지만 CPU를 많이 사용하는 작업에는 약하다.
        - 메인 스레드 실행중 병목이 발생하면 멈춘다!
- non-blocking I/O 이벤트 기반 비동기 방식
    - I/O 작업을 기다리지 않고, 이벤트로 결과를 받아 처리하는 방식.
    - JS 코드는 멈추지 않고 계속 실행되고, I/O 완료는 나중에 이벤트 형태로 알려줌.

## 6. Node.js 의 장단점

- Node.js는 **단일 스레드 + 이벤트 기반 비동기 처리 모델**을 사용해 **적은 자원으로 많은 연결을 처리**할 수 있다.
    
    → 대규모 네트워크 애플리케이션에 적합하다.
    
- **하나의 스레드에 문제가 생기면 전체 애플리케이션에 영향**을 줄 수 있다는 한계도 있다.
- 멀티 스레드를 직접 관리하지 않아도 되기 때문에, **데드락 없이 깔끔한 코드 작성**이 가능하다.
- Node.js는 컴파일 언어(C++, Go 등)에 비해 **순수 성능은 떨어지지만**, **V8 엔진 최적화 + 하드웨어 발전**으로 웬만한 웹 애플리케이션엔 충분하다.

## 7. 이벤트 루프

…

## 8. 패키지 의존성 관리

- **package.json**
    - Nest 프로젝트의 소스코드를 보면 package.json 파일이 존재한다.
    - 이 파일의 역할은
        - 애플리케이션이 필요로 하는 패키지 목록을 나열한다
        - 각 패키지는 시맨틱 버저닝 규칙으로 필요한 버전을 기술
        - 다른 개발자와 같은 빌드환경을 구성할 수 있습니다. 의존성이 달라 발생하는 문제를 예방
- **package-lock.json**
    - 프로젝트 루트 디렉토리에서 `npm install` 명령을 수행하면 `package-lock.json` 파일이 생성된다.
    - `package-lock.json` 파일은 `node_modules`나 `package.json` 파일의 내용이 바뀌면 npm install 명령을 수행할 때 자동 수정된다.
    - `package-lock.json`은 **설치된 라이브러리의 정확한 버전과 구조를 고정**해주는 파일이다.
        - 이 파일 덕분에 **누가 npm install을 해도 같은 결과가 나오게 된다.**
    - 실무에선 이 파일을 **무조건 Git에 같이 커밋**해야, 팀원이 같은 환경을 유지할 수 있다.

## 9. Typescript

- Nest 에서는 타입스크립트를 기본 언어로 채택하고 있다.

## 10. 데코레이터

> **NestJS의 데코레이터는 Spring의 어노테이션과 본질적으로 같은 개념이다.**
> 
- 데코레이터를 잘 사용하면 횡단관심사를 분리하여 관점 지향 프로그래밍을 적용한 코드를 작성이 가능하다.
- **클래스, 메서드, 접근자, 프로퍼티, 매개변수**에 적용 가능
- 선언부 앞에 `@`로 시작하는 데코레이터를 선언하면 데코레이터로 구현된 코드를 함께 실행
