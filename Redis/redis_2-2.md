# Cache Aside, Write Around 전략의 한계점 & 해결 방법

## Cache Aside, Write Around 전략의 한계점

1. 캐시된 데이터와 DB 데이터가 일치하지 않을 수 있다.
- Cache Aside 와 Write Around 전략을 같이 썼을 때의 한계점 중 하나는 캐시된 데이터와 DB 데이터가 일치하지 않을 수 있는 점이다. 
- 데이터의 일관성을 보장할 수 없다는 뜻이다.
- Write Around 전략에 따르면 데이터를 수정할 때 DB만 업데이트를 시키기 때문에 기존에 저장된 레디스의 데이터 값과 DB의 데이터 값은 다를 수 밖에 없다.

DB에 데이터를 변경했는데 아직 Redis 에는 데이터가 이전 데이터를 가지고 있음. --> 데이터의 일관성이 깨진다.

2. 캐시에 저장할 수 있는 공간이 비교적 작다.
- DB는 Disk 에 저장하기 때문에 많은 양을 저장하기 용이하지만, 캐시는 메모리에 저장하기 때문에 DB에 비해 많은 양의 데이터를 저장할 수 없다.

## 한계점 극복 방법
### 1. 캐시된 데이터와 DB 데이터가 일치하지 않을 수 있다.
캐시와 DB의 데이터를 일치시키기 위해, 데이터를 수정할 때마다 동시에 업데이트 시키면 성능적으로 느려진다. 그렇다고 성능 향상을 위해서 DB의 데이터만 업데이트 시키면 캐시와 DB의 데이터가 일치하지 않게 된다.
- 어떤 선택을 하든 기회 비용(Trade Off)이 발생
- 따라서 데이터 조회 성능 개선 목적으로 레디스를 쓰는 경우에는 데이터의 일관성을 포기하고 성능 향상을 선택
- 이러한 이유로 캐시를 적용시키기에 적절한 데이터를 잘 선별해야 한다.
  - 자주 조회되는 데이터
  - 잘 변하지 않는 데이터
  - 실시간으로 정확하게  일치하지 않아도 되는 데이터

하지만 장기간 데이터가 일치하지 않는 건 문제가 될 수 있다. 따라서 적절한 주기로 데이터를 동기화시켜주어야 한다. 
이때 활용하는 기능이 레디스의 TTL(만료 시간 설정 기능) 기능이다.


### 2. 캐시에 저장할 수 있는 공간이 비교적 작다.
- 위에서 활용했던 TTL 기능(만료 시간 설정 기능)을 활용하면 캐시의 공간을 효율적으로 쓸 수 있다. 
- 왜냐면 자주 조회하지 않는 데이터는 만료 시간에 의해 데이터가 삭제되기 때문이다. 
